<!-- Bluetooth Low Energy プロトタイピング・ガイド -->
# はじめに
この書籍は、Bluetooth Low Energy(ブルートゥース ロー エナージー、以下 Bluetooth LEと略します)を仕事で関係する方、あるいは何かをMakeする方に向けた、iOSアプリケーションそしてハードウェアの技術とプロトタイピングの解説です。

<!-- 今ベンチャーがあつい -->
いま、Bluetooth LEを用いたiPhoneとつながるハードウェアで、続々とベンチャーが生まれています。その原動力となっているのが、iPhoneです。2011年10月に発売されたiPhone4SからBluetooth LEが搭載され、その圧倒的な普及台数が、ベンチャーを駆り立てています。さらにApple社がBluetooth LEの開発環境をオープンに公開したことが、開発の難易度と費用という、ハードルを急激に下げました。

<!-- 実際にやろうとすると、たいへんだよね -->
しかし、開発をはじめると、技術以外のところが、なかなか大変です。それは、サービスやハードウェアそしてソフトウェアに通信など、いくつもの分野にまたがるために、それらの専門家達をまとめなければならないためです。本書はまず、専門家たちが協業するときに共有すべき知識をまとめた、テキストブックを目指しました。

<!-- プロトタイピングが効果的 -->
そして、Bluetooth LEのような新しいものを扱う場合には、会議室での議論とあわせて、プロトタイピングを繰り返すこと、が有効です。プロトタイピングとは、基本機能が動作するモデル(プロトタイプ)を作ることです。プロトタイピングを繰り返す過程で、メンバーで共有するイメージが現実の具体的なものものとなっていきます。そこで、本書は、ハードウェア設計の専門家でなくても、自分でできるプロトタイピングの方法をまとめました。

<!-- 分野をまたぐ変な世界だけど、グッドラック -->
Bluetooth LEの開発は、アプリケーション単体では関わることがなかった技術分野との協業、そして経験したことがない利用分野との遭遇があります。それら異種のものを取り込んでいかなければ、Bluetooto LEでの成功はありません。本書が、分野を超えた協業でのガイドブックとならんことを。

<!-- TBD:右寄せにすること。 -->
2013年7月 上原 昭宏

## 本書の開発対象と想定読者

本書の開発対象及び環境は、次のとおりです。

- OS : iOS5およびiOS6
- 開発環境 : Xcode 4.6.3
- 機種
  - iPhone4S, iPhone5
  - iPad mini, iPad (第4世代), 
  - iPod touch (第5世代)

想定読者は、Bluetooth LEの開発プロジェクトの、商品企画担当者、iOSアプリケーション開発者、およびハードウェアのプロトタイピング担当者です。

商品企画の方は、iPhone(iPadでもよいですが)を使っていて使い方がわかること、を前提とします。既存の自社製品にスマートフォン連携機能をつけたいとき、あるいは、自社のサービスでBluetooth LEを使いハードウェアを取り込むときに参考になる、技術でできること/できないこと、そして使いどころを述べます。

iOSアプリケーション開発者は、Xcodeを使いObjective-CでiOSアプリケーションが開発できることを前提とします。Bluetooth LEでの通信に使うCore Bluetoothフレームワークの説明と使い方を述べて、さらに、フレームワークの振る舞いの理解に不可欠な通信プロトコルまで解説します。

ハードウェアのプロトタイピング担当者は、ハードウェア設計が本職でなくても、例えば、書籍を読みArduinoを使ったフィジカル・コンピューティングが作れるくらいの基本的な電気回路の知識、及びブレッドボードで電気回路が組めむくらいの経験があること、を前提とします。必要最小限の機能を素早く試作する手法をいくつか述べます。

## 章の構成
本書は、5章で構成されます。各章は分野ごとに独立した内容です。必要な章のみを読めばよく、すべての章を最初から順番に読む必要はありません。まずは1章に目を通して、あとは担当分野ごとに、必要な章を読んでください。

どの章を読めばいいか、目安は以下のとおりです。カッコ書きは、読む必要はないが参考になる章です。

- 企画 : 第1章
- アプリケーション開発者 : 第1章、(第2章)、第3章、(第4章)
- ハードウェアのプロトタイピング : 第1章、第2章、(第4章)、第5章

1章は、会議をするときに共有しておくと、話が進む知識をまとめています。技術自体の解説ではなく、技術でできること、どう使われているかを述べています。例えば、Bluetooth LEは、これまでのBluetoothとは、全く違う技術です。ですから、その違いを会議の前に共有していないと、これまでのBluetoothの知識と混同して、混乱が生じるかもしれません。

新しい技術に触れた時によくあることですが、まるでそれが魔法かのように勘違いをして、とても実現できない要求を会議で決定してしまうこともあります。かといって、すべての会議に技術者を呼ぶ必要はありません。なにができるか、どうしてそれができるのか、の基礎知識さえおさえていれば、技術者である必要はありません。

2章は、Bluetooth LEの無線通信技術と規格を解説します。iOSアプリケーション開発者には、Core Bluetoothフレームワークの振る舞いを理解するのに、また通信によるトラブルが生じた時に、それを通信パケットから原因を調べる時に、有効です。ハードウェアのプロトタイピングには、ファームウェアで通信を制御するため、プロトコルを理解しておくことが必要です。

この章では、Bluetooth LEのネットワーク・トポロジとプロトコルのATT(Attribute Protocol)とGATT(Generic Attribute Profile)を、そしてサービスとキャラクタリスティクスという概念を理解します。

3章はCore Bluetoothフレームワークの解説です。まずクラスの詳細を説明して、次にBluetooth LEデバイスの発見、接続、そして通信の実装をサンプル・ソースコードとあわせて解説します。iOSシミュレータでのデバッグ方法など、ちょっとしたお役立ち情報も述べます。

4章は、Core Bluetoothフレームワークを使ったサンプル・プロジェクトです。市販されているペンやマウス、キーホルダといったBluetooth LEデバイスを使うサンプルを紹介します。

5章は、Bluetooth LEデバイスのプロトタイピング方法の解説です。一般に販売されているものでは対応できない場合は、自分たちで設計製造するほかありません。組み込み機器開発が専門でなくてもプロトタイピングできる方法をいくつか示し、サンプル・コードで具体的な製作例を示します。

<!-- 変化激しいけど電子書籍だから追従するので -->
## iOS7以降の更新
iOSのアプリケーション開発環境は、毎年大きく変化していきます。それは、Bluetooth LEも同じです。Bluetooth LEは、iPhoneと周辺機器がつながるだけではなく、ネットワーク・サービスと連携する鍵となったり、その用途は広がり変化しています。

その変化に追従して改訂していくために、本書は電子書籍として出版しました。本書で取り上げるのは、iOS5とiOS6です。iOS7については、一般公開されて秘密保持契約が解除されてから、更新する予定です。

## サンプルコード
本書のサンプルソースコードは、以下のURLからダウンロードできます。

<TBD>

ライセンスの制約はありません。ソースコードの使用や頒布、修正、派生版の頒布の制限はありません。商用、非商用に関係なく、また全体もしくは部分の利用を認めます。出典およびライセンスの明記の必要もありません。バグや問題を見つけた場合は、筆者に連絡してください。

## 免責と商標について
- 本書に登場する会社名、製品名、サービス名は、各社の登録商標または商標です。
- 本文中では、<!-- ®、™、© --> &reg;、&trade;、および&copy;マークは明記していません。
- 本書の内容に基づき実施または運用したことで発生したいかなる損害も著者は一切の責任を負いません。
- 本書の内容は2013年7月時点のものです。本書で紹介した製品およびサービスの名称や内容は執筆時点から変更される可能性があります。

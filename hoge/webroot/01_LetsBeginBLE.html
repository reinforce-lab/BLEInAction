<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" xml:lang="ja">
<head>
  <meta charset="UTF-8" />
  <link rel="stylesheet" type="text/css" href="style.css" />
<link rel="next" title="Bluetooth Low Energy技術を知ろう" href="02_BLEOverView.html"><link rel="prev" title="はじめに" href="00_preface.html">  <meta name="generator" content="Re:VIEW" />
  <title>Bluetooth Low Energy技術 をはじめよう | うれしい たのしい びーえるいー</title>
</head>
<body>
  <div class="book">
    <nav class="side-content">
      <h1>うれしい たのしい びーえるいー</h1>
      <ul class="book-toc">
<li><a href="index.html">TOP</a></li>
<li><a href="00_preface.html">はじめに</a></li>
<li><a href="01_LetsBeginBLE.html">1 Bluetooth Low Energy技術 をはじめよう</a></li>
<li><a href="02_BLEOverView.html">2 Bluetooth Low Energy技術を知ろう</a></li>
<li><a href="03_LinkLayer.html">3 リンク層の技術</a></li>
<li><a href="04_HostControllerInterface.html">4 HCI, L2CAP, SMP</a></li>
<li><a href="05_GATT.html">5 ATT, GATT</a></li>
<li><a href="06_CoreBluetooth.html">6 Bluetooth low energyのiOSアプリケーション開発</a></li>
<li><a href="07_Hardware.html">7 ものへのBluetooth Low Energy技術の取り込み</a></li>
<li><a href="08_ProtocolStack.html">8 スタックを作ってみる</a></li>
<li><a href="09_Application.html">9 利用例</a></li>
<li><a href="11_BluetoothDiff.html">10 Bluetooth Core仕様書のバージョンごとの変化</a></li>
<li><a href="10_Appendix.html">Appendix</a></li>
</ul>
      <p class="review-signature">powered by <a href="http://reviewml.org/">Re:VIEW</a></p>
    </nav>
    <div class="book-body">
      <header>
      </header>
      <div class="book-page">
        <h1><a id="h1"></a><span class="secno">第1章　</span>Bluetooth Low Energy技術 をはじめよう</h1>
<p>Bluetooth Low Energy技術は、ものとものとがおしゃべりをするような無線通信技術と言えます。では、ものとものとのおしゃべりとは、どのようなもので、また、おしゃべりするものを作ったり活用するには、どうすればできるのでしょうか。本章では、技術の活用について見ていきます。</p>
<p>もしかすると、技術に目がいき、技術を理解していれば、なんでも作れてなんでも考え出せると思うかもしれません。そして、Bluetooth Low Energy技術を隅から隅まで理解したくなるかもしれません。ですが、それは違います。</p>
<p>無線通信規格は、世界にある様々なものがお互いにおしゃべりをするための共通基盤、つまり部品にすぎません。ですから、まず最初におこなうべきは、この無線通信規格を部品として、何に用いるか、どのように活用するかを明らかにすることです。</p>
<p>まず、Bluetooth Low Energy技術の楽しみ方を見て行きます。次に、この技術の利用場面や活用方法を見ていきます。超低消費電力無線通信技術や低い製造費用、さらにはスマートホンとそのアプリケーションと、無線通信規格を基盤にして、いくつもの要素が互いに発展しながら、今あるBluetooth Low Energy技術の活用場面は形作られて来ました。それぞれの活用場面を見ていくことで、この無線通信規格の特徴とその活用方法がよくわかるはずです。</p>
<p>そして、Bluetooth Low Energy技術と自分との関わり方、そして目的と動機をはっきりさせます。趣味や好奇心あるいは学習や業務あるいは事業立案や製品企画まで、この技術との関わり方は人それぞれです。そして目的と動機がはっきりすれば、その目的から逆に道を辿ることで、その目的にたどり着くまで最短経路と必要な時間がわかります。</p>

<h2><a id="h1-1"></a><span class="secno">1.1　</span>Bluetooth Low Energy技術を楽しもう</h2>

<h3><a id="h1-1-1"></a>まずは動かしてみよう</h3>
<p>使い道と利用場面あってこその技術です。まずは、Bluetooth Low Energy技術を、この技術を活用している教育教材 micro:bit で体験してみます。</p>
<p>この micro:bit は、英国放送協会(BBC, British Broadcasting Corporation)が主体となり開発された、マイクロ・コンピュータやセンサーを搭載しているボードです。このデバイスや教育環境は、英国に本部を置くMicro:bit教育財団という非営利団体が運用しています。</p>
<p>iPhoneとmicro:bitを通信で接続して動かしてみます。クイック・スタートが、<a href="https://microbit.org/ja/guide/ble-ios/" class="link">iOSでmicro:bitを使用する - Bluetooth経由の接続</a>にまとめられています。その手順は:</p>
<p>1. micro:bitの購入と、iOSアプリケーションの入手、2. &quot;Choose micro:bit&quot;を使用してアプリとmicro:bitをペアリングする、3. プログラムを書き込み、iPhoneと接続して動作を見る、</p>
<p>の3つです。</p>
<p>まず、micro:bitを入手します。<a href="https://microbit.org/ja/resellers/" class="link">BBC micro:bitとBBC micro:bitアクセサリはどこで購入できるか</a>に購入先リストがあります。micro:bit本体は、2000円ほどで販売されています。次に、App Storeから、<a href="https://apps.apple.com/gb/app/micro-bit/id1092687276" class="link">micro:bitのiOSアプリケーション</a> を入手します。</p>
<p>アプリケーションとその画面の詳細を、TBDに示します。iOSアプリケーションを起動すると、micro:bitのできることがリスト表示された画面が出ます。micro:bitに、電源をつなぎます。マイクロUSB端子でUSBに接続するか、または電源端子に電池をつなぎます。そして、&quot;Connection&quot;を選択して、micro:bitとiPhoneとをペアリングします。これで、iPhoneとmicro:bitとが、Bluetooth Low Energy技術で通信をし始めます。</p>
<p>ペアリングが完了したならば、iOSアプリケーションの最初の画面に戻り、&quot;Flash&quot;を選択します(TBD)。中央のリストから、&quot;sample: monitor-service&quot;を選択して、その下にある&quot;Flash&quot;ボタンを押します。これで、iPhoneとmicro:bitとが、Bluetooth Low Energy技術で通信しあうプログラムが、micro:bitに書き込まれます。</p>
<p>最後に、&quot;Monitor and Control&quot;を選択します。画面下にある&quot;Start&quot;ボタンを押すと、ペアリングしたmicro:bitに接続します。micro:bitのAボタンやBボタンを押すと、その状態がiPhoneの表示に反映されます。また縦横5マスの四角をそれぞれタッチしてパターンを作ると、同じパターンがmicro:bitのLEDに表示されます。micro:bitには、加速度や磁気センサーなどがあります。画面下にある&quot;Add&quot;ボタンを押して、パネルを追加すると、micro:bitで検出しているセンサーの値をiPhoneの画面に表示できます。</p>
<p>ここまで動かせれば、あとは、新たな組み合わせに挑戦したり、遊び方を工夫したり、自分の思うままに遊びます。何をすればわからないならば、アプリケーション下部にある&quot;Idea&quot;ボタンを押すと、<a href="https://microbit.org/guide/ble-ios/#activity" class="link">https://microbit.org/guide/ble-ios/#activity</a> に、また日本語では <a href="https://microbit.org/ja/ideas/" class="link">レッスン、プロジェクト、他のアイデア</a>に、micro:bitを使う様々なアイディアとその作り方が多数掲載されています。また書籍もあります。</p>
<p>この動かしてみたは、手順通りに行っただけで、動くに決まっているものと、つまらないものに思えるかもしれません。ですが、これから何かのトラブルに直面した時に、この手順を踏めば動くと確証ができているものは、トラブルの原因を切り分ける強力な味方になります。</p>
<p>例えば、作っていると、昨日は動いていたのに今日は動かなくなることも、よくあることです。そのような場合は、この動かしてみたサンプルを micro:bit に書き込み、iPhoneのアプリケーションと接続して動くかどうかを確認します。もしも動かなければ、micro:bitかiPhoneのどちらかに原因があると考えて、どちらかを誰かから借りたもので置き換えて、また動かしてみます。もしも動くならば、自分のプログラムに原因があるのでしょう。昨日と今日とで、どこか変更した箇所がないかを確認するなどします。</p>

<h3><a id="h1-1-2"></a>Bluetooth Low Energy技術で動かしてみよう</h3>
<p>Bluetooth Low Energy技術の特徴を2つだけ挙げるならば、超低消費電力無線通信技術と、GATT基盤プロファイルです。前節でmicro:bitを、その専用iOSアプリと接続して動かしました。次は、micro:bitをBluetooth Low Energy技術で動かしてみます。</p>
<p>手順は:</p>
<p>1. &quot;nRF Connect&quot;を起動してスキャンをする、2. micro:bitに接続する、3. 加速度の値を読み出す、4. micro:bitにテキストを書き込み表示させる、</p>
<p>の4つです。</p>
<p>Bluetooth Low Energy技術の通信を見るアプリケーションは、いくつかありますが、ここでは、 <a href="https://apps.apple.com/jp/app/nrf-connect/id1054362403" class="link">nRF Connect</a> を使います。</p>
<p>まず、App Storeから nRF Connect をインストールします。つぎに、前節の手順でサンプル&quot;sample: monitor-service&quot;を書き込み、電源に接続されて動作している micro:bit を用意します。周囲に複数のmicro:bitがあると区別がつけられないので、周りにmicro:bitがない場所を確保するか、あるいは他のmicro:bitから、10から20メートルほど、十分に離れた場所に移動します。</p>
<p>そして、nRF Connectのアプリを起動します (図TBD)。初回起動時に、Bluetoothの使用をアプリに許可するかと尋ねるダイアログが表示されますから、&quot;はい&quot;を選択します。もしも、このダイアログで&quot;いいえ&quot;を選択した時は、設定アプリからnRF ConnectアプリのBluetoothの項目をオンにします。設定アプリのどこに、このアプリの設定項目があるのかを探すのは大変です。設定アプリの画面を下にスワイプすると、画面上部に検索が出てきます。この検索で&quot;nrf&quot;と入力すると、すぐに見つかります。</p>
<p>nRF Connectのアプリ画面の下部には、4つのタブ・ボタンが並んでいます。その一番右端にある&quot;Scanner&quot;をタップします。その画面の右上に&quot;Scan&quot;というボタンがあります。そのボタンを押すと、表示が&quot;Scan&quot;から&quot;Stop Scanning&quot;に切り替わります。これで、アプリがスキャンをして、Bluetooth Low Energy技術で検出されたデバイスの一覧が、アプリ画面に表示されるようになります(図TBD)。</p>
<p>デバイスの一覧の中から、&quot;BBC micro:bit&quot;を見つけて、&quot;Connect&quot;ボタンを押します。周囲に複数のmicro:bitがある時は、接続したいmicro:bitとiPhoneとをなるべく近づけて、電波強度が最も大きなものを選びます。電波強度は、デバイス名の下にある三角形の右にある、図TBDでいえば&quot;-42 dBm&quot;の部分です。もしも、micro:bitが2つ表示されていて、それぞれの電波強度の表示が -60 dBm と-40 dBm　-40 dBm の方が大きな電波強度です。</p>
<p>Bluetooth Low Energy技術で、micro:bitから加速度の情報を受け取ってみます。&quot;Connect&quot;ボタンを押して通信が接続すると、タイトル &quot;Service&quot; の画面が表示されます。画面をスクロールして&quot;micro:bit Accelerometer Data&quot;とある項目を表示します。丸に1つの下矢印と、丸に3つの下矢印の2つのボタンがありますが、ここでは3つの下矢印のボタンを押します。左の&quot;Value: &quot;に値が表示されて、micro:bitを動かすと、この値も変化して行きます。</p>
<p>次に、iPhoneからmicro:bitに情報を送ってみます。画面をスクロールして、&quot;micro:bit LED Text&quot;とある項目を表示します (図TBD)。丸に1つの上矢印のボタンを押します。書き込む値の入力ダイアログが表示されます。&quot;UTF-8&quot;を選択して、英数字で20文字以下の文字列を適当に入力して、&quot;Write&quot;のボタンを押します。書き込んだ文字列が、micro:bitに流れるように表示されます。</p>

<h3><a id="h1-1-3"></a>通信とデータ表現の仕組みを見ていこう</h3>
<p>汎用のBluetooth Low Energy技術のアプリケーションから、micro:bitが操作できました。このようなことができるのは、Bluetooth Low Energy技術が、データの構造と、そのデータの変化を通信でやり取りする方法とを、規格で決めているからです。</p>
<p>図TBDは、Bluetooth Low Energy技術で通信するiPhoneとmicro:bitと、その内部のアプリケーションの構成を示します。</p>
<p>micro:bitの内部では、Bluetooth Low Energy技術の通信制御ソフトウェアと、私達がブロックを組み立てて作ったソフトウェア(ユーザ・アプリケーション)との、2つのソフトウェアが同時に並行して実行されています。</p>
<p>無線通信は、パケットという単位でデジタル・データをやり取りしています。ですから、素直に無線通信のプログラムを作るならば、無線通信ソフトウェアとユーザ・アプリケーションとの間も、パケットの単位でデジタル・データをやり取りすればよいのです。</p>
<p>ですが、Bluetooth Low Energy技術では、通信制御ソフトウェアが、表のようなデジタル・データを持っています。この表には(インデックス、タイプ、値)の3つの列があります。1行には、インデックスは表の中での行の位置を表す値、タイプは値の種類、そして値そのものが入ります。</p>
<p>この表を見ていくと、前節のnRF Connectのアプリ画面で見た&quot;Service&quot;のタイプの行が見つかります。その&quot;Service&quot;の下の行には、&quot;Characteristics&quot;、キャラクタリスティクスというタイプの行がいくつか並びます。このキャラクタリスティクスは、前節で見た&quot;micro:bit Accelerometer Data&quot;や&quot;micro:bit LED Text&quot;などの、値の読み書きをおこなったものを表しています。つまり、表をうまく使い、サービスとキャラクタリスティクスという、データ構造を表現しています。</p>
<p>iPhoneのアプリケーションから、micro:bitの内部にあるこの表を見ると、私達の感覚で例えれば、操作パネルやリモコンに見えます。サービスは機能を表し、キャラクタリスティクスは、その機能を使うための値の読み書きを表しています。前節では、micro:bitにあるいくつものサービスのうち、加速度を取得するサービスを使い、そのキャラクタリスティクスから加速度の値を読み出しました。また文字列を書き込み、それを表示させました。</p>
<p>私達の身の回りにある電化製品には、それぞれにリモコンや操作パネルがありますが、パネルを操作して電化製品を使うのと同じように、Bluetooth Low Energy技術は、この表を活用して、多種多様なものをデジタルデータで表現して、動作や状態などを表現するのです。</p>
<p>micro:bitの内部で動作している、通信制御アプリケーションとユーザ・アプリケーションとのやり取りも、通信制御アプリケーションの内部にある表を媒介にしたものになります。例えば、外部から加速度サービスの読み出しが有効かされれば、ユーザ・アプリケーションが一定周期ごとに加速度データを読み出し、その値を表の加速度データの行の値に書き込みます。通信制御アプリケーションは、行の値が書き込まれるたびに、それをiPhoneへと伝えます。</p>
<p>つまり、Bluetooth Low Energy技術は、表形式のデータベースがあり、通信を通じてデータベースを最新の状態に同期し続ける仕組みと言えます。</p>

<h3><a id="h1-1-4"></a>さらに発展をしていこう</h3>
<p>ここまでの体験で、スマートホンと小さなデバイスとをBluetooth Low Energy技術で連携させました。これは、ただ電源を入れて動かしたのではなく、ソースコードを書きそれを転送して、挙動を作り出したのです。</p>
<p>この体験をスタートにして、多種多様な利用場面を生み出していけます。LEDを点灯した体験は、LEDをモータとそれを動かす電気回路に置き換えれば、それはiPhoneから操作するラジコンカーやロボットという体験になります。センサーやハードウェアの種類とその使い方、TBDなど実践的なレシピが参考になります。</p>
<p>ここで、ソフトウェア環境を少し深掘りしてみます。今世紀は、インターネットの普及が様々なものを大きく変化させてきました。現代のソフトウェア開発環境は、一言で言えば、プロフェッショナルとの境界がなくなったと言えます。</p>
<p>スマートホンは、数多くの優れたアプリケーションがなければ、ただの板にすぎません。Bluetooth Low Energy技術の集積回路も、多種多様なものに組み込んでいこうという人達がいなければ、売れません。より多くの人達を開発に呼び込むことが、誰にとっても利益となります。そのため、商業開発で用いられているものと同じ開発環境や情報が、個人でも無償で手に入ります。</p>

<h4><a id="h1-1-4-1"></a>iOSとmacOSのアプリケーションを作る</h4>
<p>macOSやiOSで実行できるネイティブ・アプリケーションの統合開発環境は、<a href="https://apps.apple.com/jp/app/xcode/id497799835" class="link">Xcode</a>です。Xcodeは、Apple社のmacOSを搭載するMacで動作し、アプリストアから無償で入手できます。プログラミング言語は、Apple社が開発した<a href="https://www.apple.com/jp/swift/" class="link">Swift</a>です。</p>
<p>Xcodeを試すと、言語やソフトウェアの使い方を覚える必要があり、micro:codeで体験したように、開発画面を開いて、コードを書いてすぐに動かせたらいいのに、と思うかもしれません。Apple社は、Swiftを対話的に楽しく学べるアプリケーション <a href="https://www.apple.com/jp/swift/playgrounds/" class="link">Swift Playgrounds</a> を提供しています。macOS向けの<a href="https://apps.apple.com/jp/app/swift-playgrounds/id1496833156" class="link">Swift Playgrounds</a>と、iPad向けの<a href="https://apps.apple.com/jp/app/swift-playgrounds/id908519492" class="link">Swift Playgrounds</a>が、いずれも無償で提供されています。残念ながら、iPhone向けのSwift Playgroundsはありません。</p>
<p>Swift Playgroundsにある教材は、そのまま動くアプリケーションでもあります。micro:bitの公式サイトから、Swift Playgroundsからmicro:bitを操る教材 <a href="https://microbit.org/guide/swift-playgrounds/" class="link">Swift playgrounds for the micro:bit</a> が提供されています。micro:bit以外にも、Bluetooth Low Energy技術を活用するドローンやロボットとの連携が用意されています。Swift Playgroundsは、例えばグラフ表示などアプリケーションに欲しい機能がいくつも用意されていますから、アプリケーションを作ることに集中できます。</p>
<p>Swift Playgroundsのドキュメント <a href="https://developer.apple.com/documentation/swift_playgrounds" class="link">https://developer.apple.com/documentation/swift_playgrounds</a> から、さらに使いこなすヒントが得られます。Bluetooth Low Energy技術を使う詳細は、<a href="https://developer.apple.com/documentation/playgroundbluetooth" class="link">Framework PlaygroundBluetooth</a> にあります。これを見ると、Xcodeで開発すると自分で作らなくてはならないデバイスとの接続のユーザ・インタフェースなどを補いつつ、Xcodeでの開発と変わりない高い自由度があります。</p>
<p>Swift Playgrounds は、playground booksという形式で、ローカルあるいはネットで公開できます。Playground booksの作り方は、ここに<a href="https://developer.apple.com/documentation/swift_playgrounds/creating_and_running_a_playground_book" class="link">Creating and Running a Playground Book</a>、またその配布や購読方法は、ここに<a href="https://developer.apple.com/documentation/swift_playgrounds/publishing_a_subscription" class="link">Publishing a Subscription</a> 解説があります。</p>
<p>Apple社が提供する以外の開発環境もあります。<a href="https://apps.apple.com/us/app/pythonista-3/id1085978097" class="link">Pythonista 3</a>は、プログラミング教育で広く使われるプログラミング言語 Python で、アプリケーション開発ができるiOSアプリケーションです。Microsoft社が提供する<a href="https://docs.microsoft.com/ja-jp/xamarin/" class="link">Xamarin</a>は、プログラミング言語 C# で、iOSまたAndroidのネイティブ・アプリケーションが開発できます。プログラミング言語 JavaScript でネイティブ・アプリケーションを開発する <a href="https://ionicframework.com/docs/native" class="link">Ionic Native</a> などもあります。</p>

<h4><a id="h1-1-4-2"></a>マイクロコントローラのアプリケーションを作る</h4>
<p>動かす体験で、micro:bitに転送したアプリケーションは、micro:bitに使われているNordic Semi.社のマイクロ・コントローラ nRF51822で実行されます。micro:bitのアプリケーション開発は、このマイクロ・コントローラのアプリケーション開発なのです。</p>
<p>ブロックを組み立てて実行した、micro:bitで使われている開発環境は、魅力的なコンピュータ・サイエンス学習体験を作り出すために、Microsoft社が開発した MakeCode です <a href="https://www.microsoft.com/ja-jp/makecode/about" class="link">Microsoft MakeCode とは?</a>。ブロックを配置したり、テキストでコードを書く環境は、ブラウザで動作する<a href="https://github.com/microsoft/pxt" class="link">PXT - Programming eXperience Toolkit</a>というツールで、オープンソースで公開されています。</p>
<p>せっかくですから、このPXTの解説やソースコードをざっと見てみます。PXTは、TypeScriptというプログラミング言語を、マイクロ・コントローラのプログラミングに使えるように制約を加えたプログラミング言語を使っています <a href="https://makecode.com/language" class="link">Static TypeScript is a subset of TypeScript.</a>。</p>
<p>micro:bitのアプリケーションの内部構成は、<a href="https://tech.microbit.org/software/runtime-mbed/" class="link">The micro:bit runtime and mbed programming</a>で詳しく解説されています。micro:bitにはLEDなどのいくつものハードウェアが内部にあります。それらをアプリケーションから扱いやすく抽象化するライブラリは、Lancaster大学がプログラミング言語にC言語およびC++で開発しています。アプリケーションに必要なスレッドなどの基本的な機能は、Arm社がオープンソースで提供する<a href="https://github.com/ARMmbed/mbed-os" class="link">mbed-os</a> が使われています。アプリケーションを構成しているこれらの1つ1つは、いずれもが商業開発にも用いられるもので、教育用であっても、その開発はプロフェッショナルが行っているそれと地続きなのです。</p>
<p>一般によく使われるマイクロ・コントローラ向けの統合開発環境は、Arm社の<a href="http://www.keil.com" class="link">Arm® Keil Microcontroller Tools</a>、IAR社の<a href="https://www.iar.com/jp/iar-embedded-workbench/" class="link">IAR Embedded Workbench</a>、あるいはSegger社の<a href="https://www.segger.com/products/development-tools/embedded-studio/" class="link">Embedded Studio — A Complete All-In-One Solution</a>などが有名です。</p>
<p>これらの統合開発環境は、有償のソフトウェアです。まず統合開発環境を購入し、その後は年ごとに保守料金を支払います。目安として、1ライセンスあたり年間20万円ほどかかります。統合開発環境がどのようなものか試せるように、作れるアプリケーションの大きさなどが制約された評価版が無償で配布されていますから、どのようなものかを体験したいなら評価版を使ってみてください。</p>
<p>これら3つの統合開発環境のうち、Embedded Studioは、Nordic Semi.社が自社のマイクロ・コントローラのアプリケーション開発のライセンスを一括して契約しています。自社のマイクロ・コントローラをより広く利用し、採用してもらうための努力なのでしょう。ですから、nRF51およびnRF52シリーズのアプリケーション開発は、商業開発でもEmbedded Studioが無償で使えます。</p>

<h2><a id="h1-2"></a><span class="secno">1.2　</span>Bluetooth Low Energy技術とその広がり</h2>
<p>Bluetooth Low Energy技術で動かす体験を通じて、プログラミングや通信で連携させる技を手に入れました。あとは発想と行動力で、この技術を様々な場面で使えるでしょう。ここで、この技術がどのように広がっていったのか、どのように広がっているのかを、広い視野から見渡すことで、より発想を広げていきます。</p>

<h3><a id="h1-2-1"></a>スマートホンのアプリケーションによる広がり</h3>
<p>Bluetooth無線技術の仕様は、芯となる無線通信技術のコア仕様と、機器の振る舞いを定義する承認済みプロファイルの2つで構成されます。そのコア仕様は、2010年に公開されたBluetooth4.0で、それまでの Bluetooth3.0 と、その技術とは電波で情報をやり取りする方式から異なる新技術 Bluetooth Low Energy技術の、2つの技術を含む形になりました。</p>
<p>iOSで活用できるBluetooth無線技術を活用した機器は:1. <a href="https://support.apple.com/ja-jp/HT204387" class="link">iOS が対応している Bluetooth プロファイル</a>、2. iOS独自プロファイル、3. カスタムGATT基盤プロファイル、これら3つに分類できます。この1はキーボードなど一般的なBluetooth周辺機器を、2はHomeKitやiBeaconなどが、該当します。</p>
<p>図TBDは、私達が作るiOSアプリケーションとBluetooth無線技術を活用した機器との通信を、iOS内部のソフトウェア構成で示したものです。ここで、Bluetooth3.0以前の無線通信技術とBluetooth Low Energy技術とを区別するために、Bluetooth3.0以前の無線通信技術を、クラシックBluetoothと書くことにします。</p>
<p>クラシックBluetoothで、iOSアプリケーションと連携する周辺機器が開発できます。しかし、市販されているクラシックBlueoothの無線モジュールを使うだけでは、iOSアプリケーションとの通信はできません。Apple社は、iPhoneと連携する周辺機器の開発と製造それぞれに <a href="https://developer.apple.com/programs/mfi/" class="link">MFi Program</a> を提供しています。</p>
<p>クラシックBluetoothの周辺機器は、まず利用者がiOSの&quot;設定&quot;アプリケーションで、Bluetooth機器を検索して、発見した機器との接続を開始します。iOSは、まず機器がMFiプログラムの技術情報で作られたものかを検証します。検証に通れば、iOSは、認証情報に含まれている機器と関連づけられたiOSアプリケーションに、通信をつなぎます。もしも、関連づけられたiOSアプリケーションが見つからなければ、アプリストアを表示してアプリケーションのインストールを利用者に促します。同じiPhoneにインストールされている他のiOSアプリケーションが、この通信に触れることはできません。</p>
<p>Bluetooth Low Energy技術には、一般的にはMFiプログラムがありません。ですが、Bluetooth Low Energy技術でも、MFiプログラムを通じてApple社が提供する認証技術が提供されています。具体的に何ができるかは一般には公開されておらず、MFiプログラムに参加しなければ知ることはできません。</p>
<p>Apple Watchは、iPhoneとの通信にBluetooth Low Energy技術も用いますが、そのデバイス登録はWatchアプリで管理されます。一般のBluetooth Low Energy機器のボンディング情報は、iOSの&quot;設定&quot;アプリケーションのBluetooth機器の一覧に表示されて、削除もこの画面から行います。推測にしかなりませんが、MFiプログラムの有無がこのような違いになるのでしょう。</p>
<p>Bluetooth Low Energy技術の機器は、まずiOSアプリケーションが、機器を検索して、発見した接続先の機器との接続を開始します。iOSの内部では、Bluetooth Low Energy技術の通信処理を担当するプロセスが常に動いています。このプロセスが、アプリケーションからの、デバイスの発見、接続と切断そしてGATTの読み書きの要求を処理します。また、外部からの通信も、まずこのプロセスが受け取り、iOSアプリケーションに必要な情報を渡します。</p>
<p>iOSアプリケーションがアクセスできるのは、カスタム・プロファイルです。キーボードなど、iOSがサポートするBluetooth SIGが認証するGATT基盤プロファイルは、iOSが管理しますから、iOSアプリケーションからは見えません(TBD 確認する)。</p>

<h3><a id="h1-2-2"></a>周辺機器による広がり</h3>
<p>Bluetooth Low Energy技術は、ワイヤレスのキーボードやマウスあるいはペンシルといった周辺機器に使われています。ワイヤレス周辺機器が無線通信技術に求めるものは、送るべきデータを素早く送れること、電力消費量の小ささ、そして汎用に使えることです。</p>
<p>周辺機器は、操作データが素早く届かなければなりません。キーボードのキーを押して、それが画面に反映されるのが目に見えて遅くては、入力操作がとても不愉快なものになります。では、どのくらい早ければいいのでしょうか。1画面の表示期間は、画面表示更新頻度が1秒に60回とすれば、約17ミリ秒(1ミリ秒は、1000分の1秒)です。ですから、2~3画面の表示更新よりは小さいとすれば、30ミリ秒が目安になりそうです。</p>
<p>電力消費量は小さければ小さいほど、電池交換や充電の手間が減りますから、好ましいです。特に、ペンシルのように本体が細い軸形状のものは、その本体の中に収められる電池はとても小さなものになりますから、電力消費量の小ささが求められます。ただし、例えば光学式マウスには移動距離を検出するための光学式センサがあるように、周辺機器それ自体の消費電力がありますから、それに比べて無線通信による消費電力が極端に小さくしても、全体の電力消費力はあまり変わりません。電力消費量の大きさが必要を満たしていればよいのです。</p>
<p>周辺機器は、周辺機器として使うものです。キーボードを購入したら、パーソナル・コンピュータやスマートホンに接続して、すぐに使えるべきです。特別なソフトウェアをインストールしなければ使えなかったり、あるいは特定の限られたアプリケーションでしか使えないものでは、困ります。このためには、パーソナル・コンピュータやスマートホンのオペレーティング・システムに、周辺機器を扱う機能が実装されていなければなりません。</p>
<p>Bluetooth Low Energy技術は、少しのデジタル・データを、送るべき時に素早く送れる無線通信技術です。その名前にLow Energyとあるように、超低消費電力無線通信技術を特徴としています。これはデジタル・データを送り続けることが超低消費電力なのではありません。例えば、キーボードであれば、データを送るのはキーが押されたり離された瞬間だけです。デジタル・データをやり取りすることではなく、デジタル・データをいつでも送り届けられる、無線接続した状態を超低消費電力で維持できるのです。</p>
<p>周辺機器が周辺機器として汎用に使うためには、データの意味や機器の振る舞いが1つに統一されていること、そして無線通信技術の後方互換性が維持されることが必要です。</p>
<p>Bluetooth Low Energy技術の汎用性を支えるのは、機器の振る舞いやデータの意味の定義をまとめたプロファイルと呼ぶ仕様です。プロファイルは、機器の種類ごとに作られます。Bluetooth Low Energy技術は、多種多様なものをデジタル・データとして表現する強力な仕組みを備えています。ですが、例えばキーボードのデータ表現が会社それぞれに異なっているとどうなるでしょうか。オペレーティング・システムは、キーボードという1つの分野をサポートするために、会社それぞれのデータ表現の全てに対応しなくてはならなくなります。このようなことにならないように、プロファイルがあるのです。</p>
<p>周辺機器が、新製品として発表されてから製造中止になり、最後の製品が破棄されるまでは、とても長い期間になります。Bluetooth Low Energy技術は、新たな利用場面に向けて次々と規格を更新し続けていますが、無線通信技術が更新されたから、ものが使えなくなるのでは本末転倒です。そのために、Bluetooth Low Energy技術の無線通信技術とプロファイルは、後方互換性が維持できるように考慮され、後方互換性の維持を行なっています。</p>

<h3><a id="h1-2-3"></a>iOS独自プロファイルによる広がり</h3>
<p>iOSは、iOS独自にいくつかのカスタム・プロファイルを公開しています。それらは、iOSにしか提供できないもので、iOSのユーザ体験をより豊かにするためのものです。</p>
<p>プロファイルの仕様が一般に公開 footnote:[Bluetooth for Developers, <a href="https://developer.apple.com/bluetooth/" class="link">https://developer.apple.com/bluetooth/</a> されているものは、次の2つです。これらは、MFiプログラムに参加してなくとも利用ができます:</p>
<p>- Apple Notification Center Service (ANCS)- MIDI over Bluetooth low energy</p>
<p>つぎの4つのプロファイルは、MFiプログラムの中で提供されます:</p>
<p>- ゲームコントローラ- iBeacon- HomeKit</p>
<p>メールやソーシャルメディアの通知は、スマートフォン連携での定番の機能です。様ですが、々なアプリケーションからの通知情報は、ユーザのプライバシーの保護のために、iOSアプリケーションからは読み取れません。ですから、もしもiOSアプリケーションで通知機能を実現しようとすると、アプリケーション自体に様々なメールやソーシャルメディアの通知取得機能を実装しなくてはなりません。</p>
<p>Apple Notification Center Service (ANCS)、iOSデバイスに表示されている通知表示を、そのままBluetooth Smart機器に提供する機能です。ANCSを通じて、Bluetooth Smart機器は通知情報をiOSから直接取得できます。ANCSのおかげで、通知を取得するアプリケーションをいちいち作らなくても、通知を知らせるBluetooth Smart機器が開発できます。</p>
<p>MIDI（Musical Instrument Digital Interface、ミディ）は、電子楽器の演奏データを機器間でデジタル転送するための規格です。2012年にBluetooth low energy技術でMIDIデータをやり取りするカスタム・プロファイルが、2012年にApple Bluetooth low energy MIDIとして公開されました。この仕様は、2015年にMIDI本体の規格にそのまま取り込まれました footnote:[Specification for MIDI over Bluetooth Low Energy, <a href="https://www.midi.org/specifications/item/bluetooth-le-midi" class="link">https://www.midi.org/specifications/item/bluetooth-le-midi</a>。</p>
<p>Apple Bluetooth low energy MIDIは、iOSに深く統合されています。楽器のデータは、人間が気づかない程度の小さな遅れ時間で送らなくてはなりません。そのために、この仕様は、データ形式に加えて、コネクション・インターバルを15ミリ秒以下の小さな値にすることを決めています。</p>
<p>iOSが通常受け入れるコネクション・インターバルは20ミリ秒以上ですが、Apple Bluetooth low energy MIDI対応機器は、15ミリ秒以下のコネクション・インターバルを受けつけます。また、この仕様に準じる機器は、CoreBluetoothフレームワークではなく音を扱うためのCoreAudioKitフレームワークを通じて、アプリケーションからは楽器として扱えます。</p>
<p>このようにiOSは、楽器演奏のユーザ体験に不可欠な小さな遅れ時間を、例外的な通信パラメータの受け入れで提供しています。また、Bluetoth Smart機器ではなく楽器としてアプリケーションから見えるようにしたことで、AppStoreにある数多くの演奏アプリケーションが活用できるようにしています。</p>
<p>iOSの独自プロファイルは、豊かなユーザ体験に不可欠の技術を、通信とiOSのみが実装できる機能それぞれを統合して提供しています。またカスタム・プロファイルはiOSが扱い、アプリケーションからは単なる周辺機器として見えるので、既存のアプリケーションが、そのまま利用できます。</p>
<p>HomeKit footnote:[<a href="https://developer.apple.com/homekit/" class="link">https://developer.apple.com/homekit/</a>] は、照明機器や電子錠などの身の回りにある機器とiOSデバイスとを、 Bluetooth low energy または Wi-Fi で連携させる技術です。HomeKitは、Siriを通じて自然な音声コマンドで機器が操作できるという、映画では見慣れた誰もが理解しているアプリケーションを提供しています。</p>
<p>機器が連携さえしていれば、サービス提供者やアプリケーション開発者が工夫して、多種多様なアプリケーションが新たな便利さや利用シーンを作り出されていきます。しかし、アプリケーションが登場するには、機器が連携してからしばらく時間がかかります。音声コマンドによる操作は、今はまだないサード・パーティのアプリケーションがなくとも、HomeKitを特徴づけるアプリケーションとなっています。</p>
<p>HomeKit は、機器開発のためのHomeKit対応機器の通信仕様と、iOSアプリケーション開発のための機器の登録や操作を提供する HomeKitフレームワークの2つで構成されます。HomeKit対応機器の開発は、MFiプログラムの対象です。HomeKitフレームワークは、一般開発者に開放されています。</p>
<p>電化製品を遠隔操作する技術は、古くから使われてきた技術です。例えば、1975年に開発された屋内電力配線で制御信号を送る技術X10は、電灯の遠隔操作パネルなどに欧米で広く使われています。X10のように専用制御装置を使うならば、すべての機器が屋内電力配線につながりますが、HomeKitではユーザはiOSデバイスを通じて機器とつながります。そのため、HomeKitは無線通信を使います。</p>
<p>電波は四方八方に広がるものなので、電化製品の無線化ではセキュリティの確保とプライバシーの保護が重要な課題になります。Bluetooth low energy にも、もちろんそれらの技術が盛り込まれていまが、HomeKitはそれらの技術は使っていません。HomeKitは、Bluetooth low energyを単にデータをやりとりするだけの無線通信として利用しています。セキュリティやプライバシーは、Apple社独自仕様で守られます。</p>
<p>Bluetooth Low Energy技術は、通信相手を探すために、デバイス名などの情報を表すパケットを周囲に送信するアドバタイジングという機能があります。そのデバイス名の代わりに、何かの識別情報をのせてアドバタイジングすれば、電波標識つまりビーコンになります。受信したアドバタイジング・パケットから識別情報を読み取れば、そのビーコンの電波が届く領域に入ったとわかります。また受信信号の強度から、ビーコンとの距離を大まかに推定できます。</p>
<p>このビーコンの振る舞いは、iOSではiBeacon <a href="https://developer.apple.com/ibeacon/" class="link">https://developer.apple.com/ibeacon/</a> 、AndroidではEddystone <a href="https://github.com/google/eddystone" class="link">https://github.com/google/eddystone</a> と、スマートホンのオペレーティング・システムごとに定義されています。つまり、オペレーティング・システムが決めるカスタム・プロファイルというわけです。もしもビーコンが、特定の1つのアプリケーションでだけ使えるものでは、そのビーコンの利用場面は1つだけです。ですが、オペレーティング・システムが機能を提供するならば、ビーコンと組み合わせる利用場面は無数にあり、多種多様な体験を生み出せます。</p>
<p>例えば、美術館にビーコンを設置したとします。屋内配置図とビーコンの識別子と設置位置とを、屋内位置データとして提供すれば、地図アプリケーションが屋内案内に使うかもしれません。展示解説のアプリケーションを新規開発する時に、近くにある展示物の検出に活用できるでしょう。あるいは、iOSでクーポンやチケットを管理するPassbookは、チケットと関連づける位置情報としてビーコンの識別子が使えますから、オンラインで事前購入した入場券が入り口で自動的に表示される自然な体験にも使えるでしょう。</p>
<p>ですが、多種多様な振る舞いを生み出せる範囲は、そのオペレーティング・システムの中でしかありません。幸いなことに、スマートホンのオペレーティング・システムは、iOSとAndroidの2つで占められていますから、カスタムプロファイルも2つ対応すればよいのですが、ですが手間はかかります。ビーコン設置では、この2つのオペレーティング・システムのいずれにも対応したものか、あるいはそれぞれに対応するビーコンを2つ設置せねばなりません。</p>
<p>では、仮にビーコンが、認証されたプロファイルを先に作っていたとすればどうでしょうか。おそらく、今のように広くビーコンが使われることはなかったでしょう。プロファイルは、それが特定の企業やサービスに偏るものではない一般化されたものかなど、慎重に議論されて、指摘を反映して改訂版を何度も作るため、認証には年単位の時間がかかります。特に、使われる分野や利用場面がとても広い位置情報では、誰もが合意する一般化されたプロファイルは、全ての要望を取り入れれば複雑怪奇なものになり、かといって簡素に切り落とすと合意できない利用分野も出てくるなど、認証までに長い時間がかかるでしょう。</p>
<p>iBeaconの仕様を見ると、識別子は1つの16バイトの識別子と2つの16ビットの整数で構成されていて、極めて簡素です。これは一般化された位置情報とみなす人はいないでしょう。ですが、今まで見てきたように、スマートホンが関わる場面では、この簡素な識別子で十分に利用場面が生み出せます。サービスの公開にカスタム・プロファイルは使えます。</p>

<h2><a id="h1-3"></a><span class="secno">1.3　</span>Bluetooth Low Energy技術との関わり方</h2>
<p>無線通信技術を詳しく見ていく前に、自分とのBluetooth Low Energy技術との関わり方を、はっきりさせていきます。関わり方ががわかれば、無線通信規格は部品として使うだけで内部を理解する必要はないのか、あるいはとても詳しく理解する必要があるのかがわかります。そして、個人や学習あるいは事業や業務、それぞれの視点から見える、動機と目的そして目的までの道のりの3つを見てみましょう。</p>

<h3><a id="h1-3-1"></a>関わり方をはっきりさせよう</h3>
<p>まず、ペンと紙を用意して、場所と目的や結果そして動機と、3つの項目を横に書き並べて表を作ります。そして、自分が望むBluetooth Low Enegy技術を活用している場面を思い浮かべてください。</p>
<p>この活用している場面を思い浮かべながら、数分ほどで先ほどの表に書き入れていきます。場所の項目には、自分が何かを作っている場所や活用している場所を書きます。目的や結果の項目には、完成させたものや活用している何かや手に入れた何かなどを、思いつくままに書き並べていきます。最後に、動機の項目に、自分がどのような気持ちや望みで作ったり活用しているのか、自分をかき立てるものを書き並べます。</p>
<p>この表は、自分を自分で客観的に見つめるためのもので、誰かに見せたりするものではありません。自分にわかりさえすれば良いので、どのような書き方をしてもよいものです。文章でなくても、絵を描くのもよいでしょう。何も思い浮かばない、わからないならば、これは時間をかけてよりよい結果が出てくるものではありませんから、悩むことに時間を使わずに、わからないとだけ書いておきます。あるいは、そのわからなさから感じるモヤモヤした感じを、ぐちゃぐちゃとした線の塊で表現しておくのもいいでしょう。</p>
<p>数分もあれば、表1のような表ができます。具体的な項目は人それぞれに大きく異なるでしょう。この表には、自分とBluetooth Low Energy技術との関わり様が現れます。</p>
<p>場所の項目には、作っている場所を思い浮かべていれば自宅や学校あるいは会社が、活用している場所であれば、生活の場としての自宅や人が活動したり集まる場所としての学校や会社あるいは駅や空港が並ぶかもしれません。目的や結果の項目は、まさに多種多様でしょう。例えば、スマートホンから操作するラジコンカーのような具体的なものがあるかもしれません。あるいは、プログラミング学習や、プログラムを作り動かす技能の習得があるかもしれません。形があるものではなく、これまでにない新たなサービスや事業のような、大きな目的があるかもしれません。</p>
<p>個人であれば、作り活用する場所は自宅です。結果にはスマートホンから操作するラジコンカーの様な具体的なものがあるでしょう。その動機は、何かを作りたいという好奇心や趣味です。</p>
<p>これが場所が学校であれば、作る何かは個人と同じ様な形ある何かを、教材を使い作り動かします。ですが、その目的は作ることを通じてプログラミングを学習し技能を習得することであり、またその学習と習得が動機でもあります。</p>
<p>会社であれば、まず事業計画を作りお金を集めて、人を集めて組織化して会社として立ち上げたり、あるいは企画書を作るところから始まり、社内で予算や権限を得て人を集めてチームを作ります。その動機は、製品や事業から十分な利潤を得ることです。</p>
<p>また会社で組織の一員として、事業のうち技術に関わる部分の担当になるかもしれません。検討段階で実験をするために試作品を作ったり、あるいは量産するための製品の設計を担当するかもしれません。その動機は、組織の中での役割を果たすことです。</p>
<p>さて、Bluetooth Low Energy技術と自分との関わりを明らかにしたところで、次は、代表的な関わり方を詳しく見ていきます。</p>

<h3><a id="h1-3-2"></a>個人</h3>
<p>Bluetooth Low Energy技術に個人が興味を持つことは、まずないでしょう。この技術が使われる場面を見て、それを自分でも作ってみたい使ってみたいと思い、そこにこの技術が使われているとは気づかずに使う場面がほとんどではないでしょうか。おそらく、個人が関わるのは、プログラミンング教育や好奇心あるいは趣味への活用でしょう。</p>
<p>Bluetooth Low Energy技術は、プログラミング教育教材や、ラピッド・プロトタイピング向けの電子回路に活用されています。ボタンや傾きの入力と音や光あるいはモータの動きを出力する小さな電子回路があります。この電子回路のプログラムは、パーソナル・コンピュータやスマートホンで組み立てて、Bluetooth Low Energy技術で転送して書き込めます。電子回路単体で動かすこともできますし、スマートホンと無線通信で連携させることもできます。</p>
<p>Bluetooth Low Energy技術は、スマートホンと小さな電子回路とが直接電波をやり取りする近接無線通信技術です。周囲にある他のスマートホンや小さな電子回路が、通信を中継することはありません。電波が届く距離は理想的な条件でも100メートルが限界ですから、個人の利用場面は、スマートホンの画面と、目の届く範囲で動く何かとの組み合わせになります。</p>
<p>小さな電子回路にプログラムを転送して、それ単体で動かす場面はいくつかあります。スイッチと小さな表示器で動くゲームは、パソコンやスマートホンに比べるまでもない小さな表示器ですが、小さな電子回路で動く小さなゲームは、それは独特の楽しさがあります。内蔵するセンサーで外界からの刺激に反応して動く、ものも作れます。加速度に反応して表示を変化させれば、それを手に持って大きく振ると残像で大きな表示が見えます。さらに加速度センサとモータとを組み合わせて、倒れないようにバランスを自分で調整する倒立振子というロボットも作れます。</p>
<p>小さな電子回路とスマートホンとのやり取りが生み出す振る舞いも作れます。電子回路からスマートホンへの一方向の情報の流れなら、加速度情報をスマートホンに伝える仕組みとボクシングゲームの教材とを組み合わせれば、実際の手の動きで遊ぶボクシングゲームが作れます。スマートホンから電子回路への一方向の情報の流れなら、画面に表示されたコントローラの情報と小さな電子回路につながるモータの出力制御とを組み合わせれば、スマートホンから操るラジオ・コントロール・カーが作れます。</p>
<p>加速度センサーというハードウェアでも、加速度と表示器とを連携させれば残像を利用した表示装置にしたり、スマートホンのゲームと連携する操作装置、あるいは倒立振子というロボットなど、同じハードウェアでも、振る舞いを生み出すソフトウェアにより、様々な装置になります。また、これを情報の流れとしてみれば、センサから取得した加速度の情報を、表示器に反映したり、スマートホンに伝えたり、あるいは制御プログラムを通じてモータの出力値にしています。装置の振る舞いは、情報の流れでもあるのです。</p>
<p>このような、パーソナルコンピュータやスマートホンだけはない、私達の世界に広がるプログラミング教育教材は、大げさに言えばプログラムで世界を変える体験です。映画のように、杖を振るだけで目の前の食材がたちどころに料理に変わりはしませんが、ロボット・アームを揃えてプログラムを開発すれば同じことは実現できると疑いなく思えるでしょう。</p>
<p>教材や誰かの作品を見て作りたいと思い、手順通りに組み立てても、動かないかもしれません。例題は動くのですから、自分の組み立てたものが、何かがうまくないのでしょう。まず全体の構成を見て、要素に分けます。要素ごとに動くかを確かめて、そして要素と要素とがちゃんと繋がっていくかを1つ1つ確かめていきます。問対の把握と、それを理解できる小さな領域に分割して1つ1つ確かめる原因調査は、解決方法のよい教育になります。</p>
<p>この体験は、作りたいものを思いついた時にも役立つものです。作りたいものを実現したらどうなるかを考え、それを十分小さな要素に分解して、1つ1つの要素を作り組み立てていきます。例えばボクシングゲームを思いついたとします。小さな電子回路では、加速度を取得する方法、デジタル・データをスマートホンに伝える方法の2つの要素があります。あとは、ボクシングゲームにその情報を渡す方法を調べればよいのです。</p>

<h3><a id="h1-3-3"></a>開発者</h3>
<p>個人では、動機や目的あるいは手を動かすのも、自分のものでした。開発者は、誰かが望むものを誰かの依頼を受けて完成させます。また開発は、周辺機器やアプリケーション、あるいは電子回路やソフトウェアと、それぞれの領域をそれぞれの開発者で分業して、複数の開発者で構成したチームで進めます。</p>
<p>開発者の目的は、開発業務への従事や開発成果物の納品で、金銭などの利益を得ることです。開発者に支払われる報酬は、起業であれば資本金から、すでに事業化していればサービスや製品の売り上げから支払われますから、開発者はサービスや製品と常に関わることになります。設計して製造されたものは、世界のどこかで会ったこともない数多くの人達に長い期間使われて、そして最後には破棄されて寿命を終えます。開発者の責任は、設計すれば終わりではなく、それが十分に使われて破棄されるまでです。</p>
<p>開発者チームのなかに、Bluetooth Low Energy技術それ自体の専門家がいることは、あまりありません。どの開発者も、それぞれの担当領域のなかに、Bluetooth Low Energy技術を部品として使いこなす部分が少し入ってきます。周辺機器の担当ならば、無線通信回路やファームウェアへの通信制御の実装として、Bluetooth Low Energy技術に関わります。スマートホンのアプリケーションが担当ならば、仕様書に記載された通りに、機器の発見と読み書きの機能を呼び出すだけでしょう。</p>
<p>また、たいていのサービスや製品では、開発全体でBluetooth Low Energy技術に費やす時間は、とても小さなものです。これは、無線通信技術それ自体を開発するのではなく、無線通信というものを部品として利用するだけだからです。WiFi接続設定や製品の初期設定など、製品を使い始める時に1回だけしか使わない製品も多いでしょう。</p>
<p>最初のアイディアは、どこで出てくるのでしょうか。個人のように好奇心がきっかけになることはあっても、大きなお金や費用が動くサービスや製品の開発が、好奇心だけで動いたりはしません。電化製品の製造販売の会社で、経営方針として、これからはスマートホンと連携させると決まるかもしれません。あるいは製品企画で、目新しさとしてスマートホンとの連携だと提案が持ち上がるのかもしれません。もしかすると、近づくだけでスマートホンのアプリケーションが反応するらしいから、それならこんなサービスができないかと、あやふやな見聞から、閃いてしまうのかもしれません。</p>
<p>アイディア出しからプロトタイピング、製品開発そして製造販売へと段階が進みます。段階が1つ進むごとに、費用や時間の規模は10倍あるいは100倍と桁上がりで大きくなります。また、アイディアとしてよいと思えても、実際に体験してみると思ったものと異なったり、あるいは技術要素が思った振る舞いをしないかもしれません。ですから、プロトタイピングなどの手法を用いて、アイディアを検証します。</p>
<p>アイディアを出してプロトタイピングをして、予算権限や出資者の合意を得て初めて、開発者を集める予算や資金が確保できます。そのため、アイディア出しとプロトタイピングに開発者がいないことも、よくあるでしょう。アイディア出しとプロトタイピングで、開発者として参加する時に求められるのは、設計や開発ではありません。技術知識を背景にした1つの視点からの提案や意見、また体験としての実現可能性の判断などです。</p>
<p>プロトタイピングといっても、必ずしも電子回路やソフトウェアを作るとは限りません。そのアイディアが実現した場面を紙芝居にして、色々な人に見てもらい感想を集めるかもしれません。あるいは人が黒子になったり、あるいはごっこ遊びの形で、アイディアを再現して体験してもいいでしょう。その場面を動画に記録して観察するかもしれません。</p>
<p>プロトタイピングの段階で、開発者がいなくても教育用教材やプロトタイピング向けの書籍や電子回路を活用するなどして、ほんの1部の機能でよいので、実際に動く電子回路やソフトウェアを作り体験を確認します。アイディアを出すときに想定していた技術の振る舞いが、実際には想定とは振る舞いが異なり、そのままのアイディアは実現はできないことがよくあります。プロトタイピングは、早い段階で実現可能性を確認することで時間と費用の節約になります。</p>
<p>例えば、Bluetooth Low Energy技術が無線通信し続ける技術だと聞いて、無線通信の接続と切断を、忘れ物や落し物を防止する小さなタグに利用するとします。このアイディアをそのまま実装すると、忘れ物や落し物の警告が頻繁に出てきて、とても普段使いできるものではなくなります。これは、Bluetooth Low Energy技術の無線接続は、雑音や周囲の電波状況などで、簡単に切断するものだからです。では無線通信し続ける振る舞いとはなんなのだといえば、簡単に切断しますが、またすぐに接続し直すから、見た目には無線通信が維持されます。これは、ヘッドホンのように音声や音楽のデジタル・データが常に流れ続ける用途では不適切な振る舞いですが、Bluetooth Low Energy技術は、低頻度で少量のデジタル・データを伝える技術なので、この振る舞いで、見た目では無線通信が維持されるのです。</p>
<p>プロトタイピングをうけて、試作そして量産を前提とした設計に進みます。ここで開発者のチームを組み、分担を決めて作業を進めていきます。試作では、実際に筐体と電子回路を開発して、スマートホンのアプリケーションと合わせて基本的な機能を確認していきます。この時点で、スマートホンとの連携動作の確認も取ります。試作の次は、量産を前提とした製品の設計に進みます。筐体の機構設計や電子回路そしてソフトウェアの開発はもちろん、一般的な製品開発、安全性検証から説明書の作成、また製造ラインを作り販売国での電波法の認証取得、そしてBluetooth SIGへの製品登録やサポート・マニュアルの作成と、項目は多岐に渡ります。</p>

<h3><a id="h1-3-4"></a>事業化</h3>
<p>私達の身の回りにある、ものやサービスは、様々な会社が営む事業により提供されています。事業は、営利を目的として営む経済活動です。経済活動に必要な様々なものや多様な人そして大きなお金などの資源を管理して、金銭的な利益を目的として活動する組織が会社です。事業のこの技術との関わり方は、この技術そのものが事業となるもの、事業に役立てるもの、そして事業の新たな可能性とするものの、3つがあります。</p>
<p>Bluetooth Low Energy技術そのものが、いくつもの事業により支えられています。Bluetooth無線技術の規格を作り、特許や商法を管理する団体 Bluetooth SIG は、会費や製品登録料を収入源としています。Bluetooth Low Energy技術に欠かせない、半導体や電子部品、あるいはプロトコル・スタックや開発環境などのソフトウェアを設計製造する会社もいくつもあります。</p>
<p>Bluetooth Low Energy技術を支える事業は、売り上げの増加のために、この技術が用いられる分野をさらに広げようとします。また、それぞれの分野で、この技術を採用する製品数を増やして、この技術をその分野で最も使われる無線通信技術にしようとします。Bluetooth Low Energy技術が、これまでに無線通信技術が使われてこなかった分野に向けて開発されているのは、この事業の求めに答えています。無線通信技術を採用しようとする分野を、規格や技術で制約しないように、多種多様なものを表現する柔軟な能力を持たせています。製品への採用で部品価格は常に注目される要素ですから、部品価格が安価になるように、規格で工夫されています。</p>
<p>Bluetooth無線技術は、囲い込まれた技術ではありません。規格を提供する団体 Bluetooth SIGに参加することで、この技術を担う半導体やソフトウェアを開発販売できます。また次世代の規格開発に参加することすらできます。たいていは、売り上げを増やし市場での自社製品の比率を高めるのに、権利化された自社のみが提供できる技術は、大きな強みです。ですが、無線通信には通信相手が必要です。お互いに通信しあう多種多様な製品群を生み出すためには、無線通信技術を囲い込んではならないのです。</p>
<p>Bluetooth Low Energy技術を支える事業は、この技術を使いやすくすることで競争をしています。無線通信の半導体では、年間ライセンス料金が数十万円する組み込み機器の開発者向けの統合開発環境を自社製品のソフトウェア開発向けに無償提供をしたり、誰でもが参加できる開発情報のフォーラムを解説して開発の質問に直接答えるなど、開発を容易にしています。</p>
<p>Bluetooth Low Energy技術は、つい最近登場した新しい技術です。世の中のほとんどの事業は、この技術が登場する以前からあるのですから、世の中のほとんどの事業は、この技術がなくても成り立ちます。それでも事業がこの技術を活用するのは、経費をより小さくできるか、売り上げを大きくできるかの、いずれかの場合です。</p>
<p>事業所に導入する入退室管理用の鍵システムが、たまたまBluetooth Low Energy技術を活用しているかもしれません。機密情報がある場所には権限がある人しか入れないようにするのに、通常の鍵で運用すると、紛失対応が必要になったり、あるいは鍵の複製を作られたり第3者にこっそり渡される可能性への対処も必要です。高度な生体認証機能があるスマートホンを鍵にして、そのような手間を削減しているかもしれません。</p>
<p>また鍵の製造販売の会社ならば、製品にBluetooth Low Energy技術を取り入れて、売り上げを伸ばせるかもしれません。スマートホンが使える目新しい製品として、新しいものを好むところに売れるかもしれません。入退室の権限設定と入退室のリアルタイムな記録システムもあれば、運用経費を削減したい事業所が購入するかもしれません。</p>
<p>新技術の登場と普及で、それまで困難であったり不可能なことが可能になることがあります。Bluetooth Low Energy技術は、すでに広く普及しているスマートホンと私達の世界との間にある1メートルの空間を飛び越える強力な技術ですから、事業と組み合わせれば、その活用は無数にあるでしょう。</p>
<p>ですが、新技術が登場しても私達の生活が一晩で変わることはありません。考え方や生活習慣は、それほどすぐには変化しないからです。新技術を活用した何かが登場しても、それを使うのは目新しいものを好むごく一部の人達だけです。ですが、ある時期を境にして、その何かがあることが当然かのように、急激な普及と変化が起きることがあります。そのような変化は、事業から見れば、事業は同じなのに、人々がお金を使う場所が突然切り替わるように見えます。</p>
<p>スマートホンがまだなかった1990年代に、長距離の電車移動をしようとすれば、まず駅前の旅行代理店に行き、電車の時刻表をたぐり乗り換え経路を調べてもらい、専用端末で切符を発券してもらうのに、半日はかかりました。現代であれば、スマートホンを取り出して5分もあれば完了する単なる作業です。</p>
<p>今では多くの人が、店舗以外で移動や宿泊の予約をします。それまでは駅前の立地のよいところに店舗を構える事業が、ネットワークを通じたサービスとなり、人々はそこでお金を使うようになります。このような新技術の普及が人々の消費活動の場を変えてしまう場面では、その分野で先駆者になる必要はありませんが、他社に後れを取れば売り上げを失います。</p>
<p>Bluetooth Low Energy技術の活用は、事業を変化させるかもしれません。鍵の製造販売の会社が、Bluetooth Low Energy技術を取り入れて、スマートホンで開閉できる新製品を開発したとします。これだけであれば、スマートホンのアプリケーションで操作できる鍵でしかありません。しかし、鍵というのは、所有や利用の権利を形にするものと見ることもできます。権限があるから事業所の鍵を開けて入室できるのでしょうし、支払いをしたからホテルの部屋の鍵を開けることができます。単なる新製品の鍵が、そのような権利や所有を扱う管理システムを開発して提供したり、ネットワークを通じたサービスを提供し始めれば、鍵というものを通じて、権利や所有を扱う事業へと姿を変えるでしょう。</p>

<h3><a id="h1-3-5"></a>関わり方のまとめ</h3>
<p>ここまでで、Bluetooth Low Energy技術と自分との関わり方を、場所、目的や結果そして動機という3つの項目で表にまとめ、また代表的な関わり方を3つ示しました。この大まかな区分でも、自分とBluetooth Low Energy技術の関わりと、理解の必要がある知識や分野が明確になったと思います。</p>
<p>ここでは、立場や役割を個人と学習そして事業者と3つに分けましたが、必ずしも1つの役割だけをするわけではないでしょう。初めは個人として、思いつくだけの試みを行い、それが学習につながり、やがて事業を手がけることになるかもしれません。</p>
<p>思いついたアイディアが本当によいものかを確かめるには、個人として素早く試作と実験を繰り返すでしょう。あるいは試作せずに、絵本や演劇でアイディアが実現したと想定した場面を撮影して、それを見ることで確かめようとするかもしれません。これは確かめるという結果を得るために、最も手間がかからない方法を選択するのです。ですから、すぐに壊れてしまったり、ほんの一部の機能しか実装されていなくても、よいのです。求めるものは、ある期間で実験をより多く繰り返し、あるいは探求を深めていくかであり、そのためには素早く作り素早く変更することが必要になります。</p>
<p>アイディアが事業の規模で実現ができると確信が得られれば、次は開発者の役割になるかもしれません。最初の1つを販売するまでに、開発者にはとても多くの仕事があります。設計は、妥当な品質と価格で大量生産が可能でなければなりません。人や物に害を与えない安全性が検証されていて、国ごと製品分野ごとの規格認証を取得しなければなりません。販売される製品は世界に広がり、会った事もない誰かが、知らない場所でそれを使い続けるのです。その製品が破棄されるまで、利用者が満足することはもちろんですが、安全に使われるかは、設計次第です。</p>
<p>アイディアが実証できれば、次の段階へと進めるために、資金を集めて会社を起こしたり、あるいは社内新規事業を立ち上げるでしょう。開発はもちろん、財務や法務に営業や広報それに流通や在庫管理やユーザ・サポートと、事業に必要な人材を集めてチームを作っていきます。アプセサリでは、ハードウェアとソフトウェアという分野の異なる2つのものを作りしかも連携させねばならないので、うまく機能する開発チームを作ること自体が、挑戦になるかもしれません。</p>
<p>開発者が、素晴らしいアイディアや技術的に困難だが挑戦しがいのあることを、新たに見つけて、それを手がけたいと好奇心にとりつかれるかもしれません。まず最初の1つの製品の販売にすら届いていないのに、さらに新たなアイディアに着手すれば、1つも製品を売ることもなく資金が底をつくでしょう。自ら問題を見つけて行動できる活発な人材の目線を、事業という1つの目的に向けるのは、それだけで1つの大仕事です。</p>
<p>ここまでBluetooth Low Energy技術の活用に着目してきましたが、少し視点を変えて、なぜ私達は活用を考えてきたのでしょうか。それは、Bluetooth Low Energy技術が、用途を制限することがない技術だからです。Bluetooth Low Energy技術を軸にして、ものとものとがおしゃべりをする共通基盤があります。ですが、その共通基盤をどのように使うのかは、私達自身で取り組むほかないのです。</p>

<h2><a id="h1-4"></a><span class="secno">1.4　</span>アプセサリを作るには、チームで、誰かに使ってもらう何かを</h2>
<p>ここまで、Bluetooth low energy技術の特徴と、iOSデバイスを軸としたエコシステムを見てきました。ここでは、Bluetooth low energyを活用したアプセサリを生み出すにはどうすればよいかを見ていきます。</p>

<h4><a id="h1-4-0-1"></a>ハードウェアとその体験</h4>
<p>アプセサリは、アクセサリとアプリケーションとの造語です。ですから、ハードウェアとしてのアクセサリが同じであっても、そこに掛け合わせるアプリケーションやサービスにより、様々なアプセサリが生み出されます。</p>
<p>アクセサリ、つまりハードウェア部分だけを見ると、既存の周辺機器がBluetooth Smart機器になるものと、Bluetooth low energy技術があるから初めて商品化できる機器とがあります。また機器のBluetooth low energy技術の役割は、それがなければならない必要な機能と、あってもなくてもよい追加機能であるものとに分類できます。</p>
<p>既存の周辺機器がBluetooth Smart機器になるものの例として、デジタル体重計があります。デジタル体重計は、Bluetooth low energy技術以前からある機器です。液晶パネルや電池があり、スマートホンがなくても単体で独立して使えます。そして、体重計の採択済みプロファイル Weight Scale Profile がありますから、これを採用してBluetooth Smart機器にできます。</p>
<p>もともと電子回路と電池があるデジタル体重計は、部品代がおよそ600円程度のBluetooth low energy技術の無線通信回路を追加すれば、Bluetooth Smart機器にできます。機器の工場出荷価格の目安は、およそ販売価格の3分の1です。ですから、販売価格が3000円から1万円のデジタル体重計の、工場出荷時の価格は1000円から3000円です。ですから、この600円の部品代は、けして安くはありません。</p>
<p>デジタル体重計にBluetooth low energy技術が、あってもなくてもよい追加機能か、必要不可欠の機能かは、組み合わせるアプリケーションやサービスで決まります。</p>
<p>昔から体重計を製造販売している会社であれば、低価格から高価格までの幅広い品揃えのうち、高価な部品が追加できる高価格帯の体重計にBluetooth low energy技術を付加します。これは、あってもなくてもよい機能です。また、フィットネスや体重管理のネットワーク・サービスを提供する会社であれば、自社のサービスと自然に連携させるために、Bluetooth low energy技術を採用します。これは、サービス連携のための必須機能です。</p>
<p>Bluetooth low energy技術を、追加機能にするか、必須機能にするかは、会社の方針から決まります。体重計という機器の製造販売が目的であれば、その会社は売上を増やし数多くの機器を販売するために、多種多様な体重計を製造販売します。Bluetooth low energy技術は、その多種多様な体重計の1つの追加機能にすぎません。</p>
<p>ですが、フィットネスなどのサービスが目的であれば、その会社はサービスをより魅力的にして多くの利用者の獲得が目的になります。ですから、体重計は、そのサービスのブランド・イメージに適した機種が1つあればよく、多種のものを販売する必要はありません。Bluetooth low energy技術は、サービスとの連携に必須です。</p>

<h4><a id="h1-4-0-2"></a>ブレインストーミングとプロトタイピング</h4>
<p>アプセサリを、その体験に注目すると、ハードウェアとしての機器や、アプリケーションあるいはネットワーク・サービスの開発は、その体験を生み出すための大切な要素ですが、要素にすぎません。体験を生み出し、その体験を提供し続けるための事業を立ち上げるのは、チームにしかできません。</p>
<p>アプセサリの企画では、ブレインストーミングが役に立ちます。ブレインストーミングは、参加メンバーがアイディアを出しあい、そのアイディアを批判せず前向きに展開し続けることで、アイディアの連鎖反応や発想の誘発を期待する会議手法です。</p>
<p>また、ブレインストーミングには、プロトタイピングが活用できます。プロトタイピングは、試作品を作り早期に企画や体験の検証を短期間で繰り返す手法です。専門分野の異なるチームでは、メンバー同士の認識のすり合わせにプロトタイピングが有効です。</p>
<p>粘土をこねて外形を作ったり、あるいは目標とする機器とは大きさも形も違うとしても、例えばApple Watchのアプリケーションである程度の機能を作り、手で触れて動かして遊ぶと、驚くような発見や広がりそして展開につながります footnote:[Designing for Future Hardware, <a href="https://developer.apple.com/videos/play/wwdc2015/801/" class="link">https://developer.apple.com/videos/play/wwdc2015/801/</a>]。</p>

<h4><a id="h1-4-0-3"></a>センサー・デバイスと測定値</h4>
<p>素晴らしいアプセサリを思いつこうとしても、とりかかりがなければ、考えようがありません。また、素晴らしいアプセサリの体験のアイディアが出ても、そのアクセサリが今ある技術で現実的な価格で製造可能でなければ、実現はできません。センサー・デバイスと測定値の知識は、実現可能なアプセサリを考える手がかりになります。</p>
<p>測定値は、ある量の大きさを計器、センサー、で測定して得られた値をいいます。世の中には様々な種類や精度のセンサーがありますが、圧力、温度、湿度、加速度、角速度、あるいは磁場などのセンサーがあります。センサー技術は絶えず進歩していて、驚くほどの高い感度や精度や機能がある新製品が登場しています。数センチメートルの高低差に相当する気圧変化が検出できる気圧センサーは、階段の昇降の検出すらできます。</p>
<p>最も身近なセンサーは、スマートホンに使われているものです。スマートホンに使われるセンサーは、大量生産されているので、高性能なものが安価に入手できます。例えば、スマートホンに使われるセンサーとその用途は次のものがあります。</p>
<p>* 磁気センサー** コンパス* 光センサー** 画面の明るさ調整(照度センサー)** 顔と画面の相対位置検出 (光学式近接センサー)** 写真撮影 (イメージセンサー)* 音センサー** マイク* 静電容量分布センサー** タッチ検出* 加速度、角速度、気圧センサー** デバイスの向き検出** 歩数や運動量の検出* 気圧センサー** 高度</p>
<p>アプセサリが提供するものは、利用者の体験です。ですから、センサーの計測値そのものではなく、その計測値が利用者の体験にどう関わるのかが重要です。センサーがどこに取り付けられているかが、計測値の意味を決めます。計測値がそのままで使うことは、あまりありません。いくつかの計測値を組み合わせたり、計測値を数値計算をして価値のある値を取り出したりします。</p>
<p>例えば、熱中症の危険を検出したいならば、気温だけではなく湿度も計測しなければなりません。またセンサーは、人の近くになければ意味が無いでしょう。あるいは、スマートホンのような常に携帯している機器では、その加速度は人の動きの情報そのものです。ですから、その加速度から歩数や消費カロリーの推定値を算出できます。</p>

<h4><a id="h1-4-0-4"></a>アクセサリのライフサイクルと収益</h4>
<p>アプセサリはアクセサリとアプリケーションおよびサービスの2つの部分があります。アクセサリは、設計製造されて、流通し販売されて、利用され、そして破棄されて、そのライフサイクルを終えます。アプリケーションおよびサービスは、利用者から見ると、アクセサリを初めて購入した時点で利用が開始し、アクセサリを買い換えてもサービス利用は継続します。</p>
<p>ですから、アプセサリの売上は、アクセサリの売上と、アプリケーションおよびサービスの利用料金の2つです。したがって、売上を得る組み合わせは、アクセサリの売上のみでサービスは無料、アクセサリは無料でサービスは利用料金がかかかる、あるいはアクセサリの売上とサービスの利用料金がいずれもかかる、3つの組み合わせがあります。</p>
<p>フィットネス分野のアプせサリは、アクセサリの売上のみでサービスは無料のものが多くあります。それはアプセサリの売上にサービス利用料金を含めることに成功しているからです。単なる万歩計は1000円程度で販売されています。しかし、サービスと連携するBluetooth Smart機器の万歩計は5000円���くで販売されています。利用者がサービス連携の価値を認めることで、アクセサリの販売価格にサービス利用料金を含められています。</p>
<p>また、アプセサリのサービスをアクセサリの売上だけで運営維持していくためには、アクセサリかもしくはその消耗品が定期的に売れ続けなければなりません。フィットネス分野のアクセサリは、落下や洗濯による利用者のミスによる故障や、外装が汚れてくるなどで買い替えが期待できます。また、新しいデザインや新機能がある新モデルの定期的な投入も、買い替えにつながります。</p>
<p>あるいは、サービスのためのアクセサリならば、課金はサービス側で行い、より多くの人に使い始めてもらうために、アクセサリは実質無償とします。一般向けの決済サービスであれば、クレジットカードを読み取るアクセサリは安価で販売して、サービス利用時にその購入代金をポイントなどで利用者に戻して、実質無料で提供します。企業向けの勤怠管理システムであれば、まず利用を始めてもらえるように、機器はリースにして導入費用を低くして、利用料金で機器の費用を回収します。</p>
<p>アプセサリの事業規模は、利用者が増えるほど大きくなります。これには、アプセサリを知ってもらうこと、興味を持ってもらうこと、購入して利用してもらうことが必要です。フィットネス機器は、身につけている機器が他人から見えますから、、人のつながりと口コミで商品の認知が広まります。さらに、目標の活動量達成を自動的にソーシャル・メディアに投稿する機能があると、ネットワークを通じてもアプセサリの認知が広がります。</p>
<p>アクセサリには、ある場所に設置できるアクセサリは1つだけという場所の排他性と、あるアクセサリを利用していれば同様の別のアクセサリに入れ替えることはないという手間のための排他性とがあります。ですから、アプセサリの事業は、最初に利用されたものや、最初に導入されたものが強い立場を得ます。例えば、腕時計は2つ身につける人はいません。あるいは、企業向けのサービスであれば、別会社のサービスに切り替えることは、機材の入れ替えなど大変な手間がかかりますから、まずありません。</p>

<h4><a id="h1-4-0-5"></a>開発とそのチーム</h4>
<p>事業化を目指すアプセサリの開発は、ハードウェアやソフトウェアなど、いくつかの分野にまたがるために、その開発はチームでおこなうことになります。</p>
<p>プロジェクトは、アクセサリとサービスの試作などのプロトタイピングとその体験の確認の繰り返しに始まり、量産を前提とした試作、そしてサービスを開始してからは不良品対応やユーザー・サポートなどの運営へと進みます。プロジェクトの段階にともない、チームやその構成メンバーは変更されていきます。</p>
<p>プロトタイピングでは、分野を超えた連携が特に重要です。体験と設計そして実装とが、うまく組み合わさらないと、後の詳細実装で実装ができないことがわかりプロトタイピングからやり直しになり時間と費用を消耗したり、工夫をすれば実装ができることに気がづけずに、よい体験を逃したりします。分野を超えてお互いに工夫を出しあうことが重要です。</p>
<p>ハードウェアとアプリケーションが、それぞれ別の開発チームであるならば、チーム間での成果物の渡し方と渡す時期の設定に工夫が必要です。</p>
<p>チーム間で成果物を渡す時には、その成果物だけで動作が確認できるようにします。試作したハードウェアをアプリケーション開発チームに渡す時は、ハードウェアだけではなく、動作確認用のアプリケーションも渡すようにします。開発中にハードウェアの挙動がおかしい場合は、動作確認用アプリケーションがあれば、その原因がハードウェアなのか通信あるいはアプリケーションにあるのかを切り分けられます。</p>
<p>チームからチームへの成果物の公開は、ファイル共有やプロジェクト管理サービスを使い、常に行います。開発プロセスの1つを完成させてから次のプロセスを進める方法では、すべてのプロセスが直列に並び開発期間がとても長くなるのと、どこかで不具合が判明した時にその修正にかかる時間がとても長くなります。</p>
<p>試作が完了すれば、次に量産のための試作、そして製造へと移行します。製造設備を所有していなければ、製造ができるパートナーも見つけ出さなければなりません。体験のための試作と、量産のための試作は異なります。製造のしやすさや製造費用の低減はもちろん、人への安全性などのリスク分析や、説明書への記載、リサイクルや環境への配慮などの、市場で販売するために必要な考慮が含まれます。</p>
<p>また、Made for iPhoneプログラムには、設計者ライセンスと製造者ライセンスがあります。iBeaconのように、iOS独自の認証技術が用いられていないものでは、通常のBluetooth Smart機器として製造ができます。ですが、HomeKitのように高度な認証技術が使われるものは、Made for iPhoneの製造者ライセンスを取得している製造パートナーを探します。</p>

<h4><a id="h1-4-0-6"></a>電波法とBluetoothの認証</h4>
<p>市場で販売される機器には、機器がお互いに機能できるように、認可や申告の義務があります。電波を送信するBluetooth Smart機器には、電波法の遵守と、Bluetooth無線技術の認可の取得と製品申告が必要です。</p>
<p>電波は公共の資源です。電波は四方八方に広がるため、混信や妨害が起きないように、国が周波数の割当や事業者への割当をおこないます。Bluetooth Smart機器は、電波を送信するので、小さいながらも無線局です。電波法に従わない勝手な無線設備の運用には、罰則規定があります footnote:[電波法 第百十条 次の各号のいずれかに該当する者は、一年以下の懲役又は百万円以下の罰金に処する。]。</p>
<p>無線技術の知識がない人が免許がなくても利用できるように、無線設備を電波法に適合するものとして認証する制度があります。これが、技術基準適合証明制度(技適)および工事設計認証制度です。</p>
<p>技術基準適合証明制度は、無線設備を1台づつ試験をして技術基準に適合しているかを判断して認証するもので、1回の申請で最大500台まで申請できます。これは、試作あるいは少数製造で利用されます。</p>
<p>製造では、工事設計認証制度が使われます。これは、無線設備の設計とその製造設備が基準を満たすことを認証します。この制度は、同じ特性の無線設備が製造できる工場で製造された1台の無線設備を試験して、その1台が技術基準に適合してれば、これから同じ特性で製造される無線設備も技術基準を満たすだろうというものです。</p>
<p>これらの制度を利用しても、製品ごとに認可を取るのは大変です。そこで使われるのがモジュール状の特定無線設備、つまり無線モジュールです。無線モジュールとは、発振部などの電波の特性に直接影響を与える部分を1つの基板や集積回路にまとめたものです。無線モジュールで、技術基準適合証明または工事設計認証を取得していれば、無線モジュールを組み込んだ最終製品で認証を取得する必要はありません。</p>
<p>ですから、Bluetooth Smart機器の試作と量産では、無線モジュールがよく使われます。しかし、無線モジュールが使えない小型や曲面のように特殊な形状のものでは、無線回路から設計します。このときは、電気回路の設計と試作ではシールドボックスやシールドルームという、電波を外に漏らさない箱や部屋で試験をします。また屋外で体験を検証するときは技術基準適合証明を、製造時は工事設計認証を製品に対して取得します。</p>
<p>電波法は国ごとに異なります。Bluetooth Smart機器を米国で販売するには、通信や電波の利用を管理する連邦通信委員会(Federal Communication Commission、FCC)の認証の取得が必要です。これには、日本国の技術基準にはない、機器から意図せず放射される電磁波の強度測定が含まれます。</p>
<p>このように、電波法の基準やその認証制度とその運営は国ごとに異なります。どのような試験項目があるのかは設計段階から把握し対応しなければ、試験に通らず再設計することになります。また、1回の測定で複数の国に提出できるデータを取得できるものもあります。ですから、量産のための試作では、認証サービス会社や製造パートナーと、事前にどの国で販売するかを設定して、技術評価項目を確認しておきます。</p>
<p>Bluetooth機器を自社製品として販売するには、Bluetoothの認可を取得して製品申告をします。これには、Bluetooth無線技術の知的財産と商標のライセンシングが含まれます footnote:[Bluetooth 認証および申告プロセス <a href="https://www.bluetooth.org/ja-jp/test-qualification/qualification-overview" class="link">https://www.bluetooth.org/ja-jp/test-qualification/qualification-overview</a>。申告料金は、アソシエイトメンバーであれば4,000米ドル、年会費が無償のアダプターメンバーであれば8,000米ドルです。年間収入が1億米ドル以下の中小企業のアソシエイト会員の年会費は7,500米ドルですから、1年間に2つ以上の製品を登録するならば、アソシエイトメンバーになる方が得です。</p>
<p>また、小さな新興企業が最初のBluetooth製品を商品化できるように、イノベーション奨励プログラムがあります。年間収入が100万米ドル未満で、以前に申告をしたことがない企業は、2,500米ドルの割引金額で最大2つの申告を受けることができます。</p>

<h3><a id="h1-4-1"></a>{ch01-まとめ} まとめ</h3>
<p>この章は、利用場面を例にして、Bluetooth low energy技術の特徴とそのエコシステムとを見ていきました。無線通信には必ず通信相手がいます。ですから、通信相手がそれぞれ普及しないかぎり、新しい無線技術は普及しはじめません。Bluetooth low energy技術は、スマートホンという通信相手の登場により、急激に普及しはじめました。</p>
<p>従来版Bluetooth無線技術は、無線通信と機器のデータ表現を組み合わせて最適な技術を提供していました。ですが、Bluetooth low energy無線技術は、ものをデータベースとして表現する、通信を意識しなくてもよい、GATT 基盤アーキテクチャを採用しました。</p>
<p>Bluetooth low energy技術のエコシステムは、機器の製造販売、アプリケーション開発、そしてサービス提供といった、事業の目的も利益も違う事業者の関わりあいで支えられます。Bluetooth low energy技術は、このエコシステムのつながりのよりどころなのです。</p>
<p>Bluetooth SIGの採択済みプロファイルをよりどころにして、周辺機器やフィットネスなどの機器市場へのBluetooth low energy技術の普及をみてきました。そして、カスタム・プロファイルとアプリケーション開発がもたらしたアプセサリと呼ばれる新しい利用分野を見てきました。</p>
<p>Bluetooth low energy技術は、その強力なブランド力で、身の回りにある様々な物と物事のための無線通信技術として、ますます普及していくでしょう。</p>
      </div>
      <nav class="book-navi book-prev">
                <a href="00_preface.html">
          <div class="book-cursor"><span class="cursor-prev">◀</span></div>
        </a>
              </nav>
      <nav class="book-navi book-next">
                <a href="02_BLEOverView.html">
          <div class="book-cursor"><span class="cursor-next">▶</span></div>
        </a>
              </nav>
    </div>
  </div>
  <footer>
      </footer>
  </body>
</html>
